Consider running the loop inside the GPU in order to avoir kernel launch overhead